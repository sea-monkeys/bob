Explain the provided source code and generate sequence and state mermaid diagrams